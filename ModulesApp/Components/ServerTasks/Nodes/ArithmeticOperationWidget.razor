@using Blazor.Diagrams.Components.Renderers;
@using Blazor.Diagrams.Core.Models
@using ModulesApp.Interfaces
@using MudBlazor

<NodeWidget Node="Node"
            BoolOutputText="false"
            Header="@Node.OperationType.ToString()"
            MainColor="var(--arithmetic-operation-node-color)">

    @if (Node.InputType == NodeInputType.Single)
    {
        <MudNumericField T="double"
                         @bind-Value="Node.DoubleVal1"
                         Variant="Variant.Outlined"
                         Margin="Margin.Dense"
                         Immediate="true" />
    }
    <MudSwitch T="bool" ValueChanged="SwitchInputType" Size="Size.Small" Value="ToBool(Node.InputType)">
        @Node.InputType input
    </MudSwitch>
</NodeWidget>

@code
{
    [Parameter] public ArithmeticOperationNode Node { get; set; } = null!;

    private void SwitchInputType(bool inputType)
    {
        if (inputType)
        {
            Node.AddInputPorts(NodeInputType.Double);
        }
        else
        {
            Node.AddInputPorts(NodeInputType.Single);
        }
    }

    private bool ToBool(NodeInputType type) => type == NodeInputType.Double;
}