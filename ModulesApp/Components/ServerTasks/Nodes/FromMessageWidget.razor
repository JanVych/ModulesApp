@using ModulesApp.Components.ServerTasks.Ports
@using ModulesApp.Interfaces
@using ModulesApp.Models.ServerTasks
@using MudBlazor

<TaskNodeWidget Node="Node"
                Header="From-Message">

    <MudSelect T="long"
        Value="Node.LongVal1"
               ValueChanged="ChangeType"
               Variant="Variant.Outlined"
               Label="Type"
               Margin="Margin.Dense">
        <MudSelectItem Value="(long)NodeValueType.Any">@NodeValueType.Any</MudSelectItem>
        <MudSelectItem Value="(long)NodeValueType.String">@NodeValueType.String</MudSelectItem>
        <MudSelectItem Value="(long)NodeValueType.Number">@NodeValueType.Number</MudSelectItem>
        <MudSelectItem Value="(long)NodeValueType.Boolean">@NodeValueType.Boolean</MudSelectItem>
        <MudSelectItem Value="(long)NodeValueType.Array">@NodeValueType.Array</MudSelectItem>
    </MudSelect>

    <MudTextField T="string"
                  Label="Key"
                  @bind-Value="Node.StringVal1"
                  Variant="Variant.Outlined"
                  Margin="Margin.Dense" />

</TaskNodeWidget>

@code
{
    [Parameter] 
    public FromMessageNode Node { get; set; } = null!;

    private void ChangeType(long value)
    {
        Node.LongVal1 = value;
        var port = Node.Ports.FirstOrDefault() as TaskPort;
        port!.DataType = (NodeValueType)value;
    }
}